---
name: ansible-content-action
description: This is a monolythic action for Ansible contnet testing
author: Sagar Paul
inputs:
  path:
    description: >
      Specific path to lint instead of the default `.`. Multiple arguments are
      not supported and you will need to alter linter configuration to
      accommodate other use cases.
    required: false
    # That default is just a placeholder workaround for no arguments use-case
    # Feeding "." or empty string to ansible-lint makes it believe it is a role
    default: --show-relpath
  args:
    description: deprecated
    deprecationMessage: >
      Arbitrary args are no longer accepted, please use path instead and
      linter own configuration file to change its behavior.
    required: false
    default: ""
runs:
  using: composite
  steps:
    - name: Checkout code
      uses: actions/checkout@v2
      # if: ${{ github.job == 'ansible-lint' }}

    - name: Set up Python
      uses: actions/setup-python@v2
      if: ${{ github.job == 'ansible-lint' }}
      with:
        python-version: 3.x

    - name: Install Ansible and dependencies
      shell: bash
      run: |
        python -m pip install --upgrade pip
        pip install ansible ansible-lint

    - name: Run Ansible-lint
      shell: bash
      run: ansible-lint
